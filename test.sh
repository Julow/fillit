#!/bin/bash
# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    test.sh                                            :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: jaguillo <jaguillo@student.42.fr>          +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2016/11/10 18:50:13 by jaguillo          #+#    #+#              #
#    Updated: 2016/11/14 14:39:09 by ccompera         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

N=${1:-7}

echo N = $N

PREFIX="/tmp/_TEST_"

for i in ""{1..125};
do
	if ! python << EOF > "${PREFIX}map" 2>/dev/null
import random

PIECES = [
	"#...\n#...\n#...\n#...",
	"####\n....\n....\n....",
	"#...\n##..\n.#..\n....",
	".##.\n##..\n....\n....",
	".#..\n##..\n#...\n....",
	"##..\n.##.\n....\n....",
	"##..\n##..\n....\n....",
	".#..\n###.\n....\n....",
	"#...\n##..\n#...\n....",
	"###.\n..#.\n....\n....",
	"#...\n###.\n....\n....",
	"..#.\n###.\n....\n....",
	".#..\n.#..\n##..\n....",
	"###.\n#...\n....\n....",
	"#...\n#...\n##..\n....",
	"##..\n#...\n#...\n....",
	"##..\n.#..\n.#..\n....",
	"###.\n.#..\n....\n....",
	".#..\n##..\n.#..\n...."
]

print("\n\n".join([random.choice(PIECES) for _ in range($N)]))

EOF
	then
		break
	fi
	if ! time ./fillit < "${PREFIX}map"
	then
		echo ERROR:
		cat "${PREFIX}map"
		break
	fi
	echo
done

echo "done             "
